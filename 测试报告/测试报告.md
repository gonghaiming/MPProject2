##迷你认证系统测试文档
[TOC]
##项目背景功能
1. 客户端发起认证请求到服务器，服务器认证用户身份，返回用户认证结果，如果成功返回用户的权限级别。
2. 客户端与服务器端采用UDP协议通信，服务器地址和端口在客户端事先指定。
3. 服务器上需要有一张用户表，表的内容包括用户名，密码，以及用户的级别
4. 需要设计考虑用户的密码信息传输安全
5. 请求类型即code值包括：
    - 		auth-request
    - 		auth-access
    - 		auth-reject
6. 服务器支持多客户端并发请求

##测试方法
-   本次测试均采用黑盒测试方法

##基本功能测试
####客户端

1.客户端的用户名密码键入[合格]
  
测试数据：
- （1）输入用户名：hello 密码：000000
  	   打印输入信息： hello 000000
- （2）输入输入用户名：world 密码：123456
  	   打印输入信息： world 123456

2.客户端的报文封装打印和延时处理[合格]

测试数据：
- （1）输入用户名：hello 密码：000000
  	   打印报文信息： 
![QQ图片20160428202046.jpg](.\QQ图片20160428202046.jpg)
         
- （2）输入用户名：world 密码：123456
  	   打印输入信息： 
![QQ图片20160428202100.jpg](.\QQ图片20160428202100.jpg)


3.客户端的报文发送[合格]

测试数据：
- （1）输入用户名：hello 密码：000000
		服务器接收成功，有回应
- （2）输入用户名：world 密码：123456
		服务器接收成功，有回应

4.客户端的回应报文接收与解析[合格]

测试数据：


####服务器

1.服务器的报文接收和解析[合格]
  
测试数据：

2.服务器的数据库认证[合格]

测试数据：

3.服务器的回应报文封装与发送[合格]

测试数据：

##单元测试代码
- 解析模块：
```c

	int main(int argc, const char * argv[]) {
    pktcontent content[2];
    
    content[0].type = 1;
    content[0].lengthItem = 8;
    content[0].value[0] = 'a';
    content[0].value[1] = 'b';
    content[0].value[2] = 'c';
    content[0].value[3] = 'd';
    content[0].value[4] = 'e';
    content[0].value[5] = 'f';
    
    content[1].type = 2;
    content[1].lengthItem = 12;
    content[1].value[0] = 'a';
    content[1].value[1] = 'b';
    content[1].value[2] = 'c';
    content[1].value[3] = 'd';
    content[1].value[4] = 'e';
    content[1].value[5] = 'f';
    content[1].value[6] = 'g';
    content[1].value[7] = 'h';
    content[1].value[8] = 'a';
    content[1].value[9] = 'd';
    
    int length = 0;
    
    char buff[1500];
    memset(buff, 0, 1500);
    
    length = clientSerialized(buff, content);
    
    printf("%s ",buff);
    printf("pktLength = %d\n",length);
    
    userInfo userinfo;
    userinfo.previlage = 1;
    deserialized(buff, &userinfo);
    printf("username = %s\n",userinfo.name);
    printf("password = %s\n",userinfo.password);
```
***
- 加解密模块：
```c
	#include <stdio.h>
	#include "common.h"
	int main(int argc, const char * argv[]) 
    {
    // insert code here...
    
    char *password1 = "";
    char hash[33];
    mini_encrypt(password1, hash);
    
    password1 = "13123124";
    mini_encrypt(password1, hash);
    
    password1 = "sldajflk12";
    mini_encrypt(password1, hash);
    
    
    password1 = "1asdf12312";
    mini_encrypt(password1, hash);
    
    password1 = "asdfjadsfj";
    mini_encrypt(password1, hash);
    
    password1 = "chasdjfk";
    mini_encrypt(password1, hash);

    return 0;
}
```


- auth用户信息验证模块：
```c
#include <stdio.h>
#include <assert.h>
#include "common.h"
#include "auth.h"

int main(int argc, const char * argv[]) {

    
    
    char *username = "hello";
    char *password = "123";
    
    int retValue;
    retValue = authentication(username, password);
    assert(retValue != 1);
    
    
    
    
    username = "world";
    password = "000000";
    retValue = authentication(username, password);
    assert(retValue == 2);
    
    username = "world";
    password = "00";
    retValue = authentication(username, password);
    assert(retValue == 0);
    
    username = "wo123";
    password = "00";
    retValue = authentication(username, password);
    assert(retValue == 0);
    
    printf("数据库认证模块单元测试用例通过\n");

    
    return 0;
}
```
##测试结果

![QQ图片20160428220837.jpg](.\QQ图片20160428220837.jpg)


##缺陷统计

- 输入为空无处理
![QQ图片20160428203152.jpg](.\QQ图片20160428203152.jpg)

